import fetch from 'node-fetch';

import {API_URL} from './constants.mjs';

export async function fetchWithAccessToken(path, parse = 'json') {
    const url = path.startsWith('http') ? path : API_URL + path;
    try {
        console.log(url);
        const response = await fetch(url, {
            headers: {
                'X-Figma-Token': process.env.ACCESS_TOKEN,
            },
        });
        if (parse === 'json') {
            const result = await response.json();
            console.log(result);
            return result;
        }
        if (parse === 'text') {
            const result = await response.text();
            console.log(result);
            return result;
        }
        return response;
    } catch (reason) {
        console.log(reason);
    }
}
