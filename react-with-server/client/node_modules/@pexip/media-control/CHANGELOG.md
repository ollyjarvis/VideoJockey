# Changelog

## 18.3.0

## 18.2.0

### Minor Changes

- 6cb27d9: Rename hasOwnProperty to hasOwn and use hasOwn when available

### Patch Changes

- Updated dependencies [6cb27d9]
  - @pexip/utils@16.12.0

## 18.1.0

## 18.0.0

### Minor Changes

- 79d02d8: Allow triggering new GUM if the track is muted.
- bfb8058: Add `maskCombineRatio` Constraint

  - Add `maskCombineRatio` Constraint
  - Rename bgImageUrl to backgroundImageUrl
    https://gitlab.com/pexip/zoo/-/issues/2776
  - Remove `flipHorizontal`

### Patch Changes

- Updated dependencies [bfb8058]
  - @pexip/utils@16.11.0

## 17.4.0

### Minor Changes

- fec1c90: Format following Prettier update

### Patch Changes

- Updated dependencies [4a1908a]
- Updated dependencies [ec134d1]
- Updated dependencies [24fe7e1]
  - @pexip/utils@16.10.0

## 17.3.0

### Minor Changes

- 7b29d953: Update babel/traverse related deps
- 821d9a1ef8: Add toMediaDeviceInfo util function

### Patch Changes

- Updated dependencies [7b29d953]
  - @pexip/utils@16.9.0

## 17.2.0

### Minor Changes

- 244cb04c: Add screen capture constraints

  - Add screen capture constraints
  - Add fallback implementation of `mointorTypeSurfaces`
  - Fix typo of `areMultipleFacingModeSupported`

- 26878b60: Add contentHint to InputConstraintSet
- 7e02391e9c: Changest to support FECC and PTZ capabilities

### Patch Changes

- 4ea55a5205: Prettier and linting for new prettier version.
- Updated dependencies [244cb04c]
- Updated dependencies [4ea55a5205]
  - @pexip/utils@16.8.0

## 17.1.2

## 17.1.1

## 17.1.0

### Minor Changes

- 4298b039: Add `resizeMode` type as it is not supported cross-browser

### Patch Changes

- Updated dependencies [9fa7884d]
  - @pexip/utils@16.7.0

## 17.0.0

### Patch Changes

- @pexip/utils@16.6.0

## 16.7.1

### Patch Changes

- Updated dependencies [94b7f753]
  - @pexip/utils@16.6.0

## 16.7.0

### Minor Changes

- 05ef9099: Remove some default constraints

### Patch Changes

- Updated dependencies [456c06c6]
  - @pexip/utils@16.5.0

## 16.6.0

### Minor Changes

- f8d4190238: Take portrait mode into account when comparing resolutions
- f8d4190238: Add facing mode utility functions
- f8d4190238: Add more utility functions

### Patch Changes

- Updated dependencies [3ba403f688]
  - @pexip/utils@16.4.1

## 16.5.0

### Minor Changes

- 6225612: Remove @pexip/logger dependency

### Patch Changes

- Updated dependencies [e6ef1f2]
  - @pexip/utils@16.4.0

## 16.4.0

### Minor Changes

- 6496a9d: Extract device kind comparison

## 16.3.1

### Patch Changes

- Updated dependencies [4763e5b4]
  - @pexip/utils@16.3.1

## 16.3.0

### Patch Changes

- @pexip/utils@16.3.0

## 16.2.0

### Patch Changes

- @pexip/utils@16.2.0

## 16.1.0

### Patch Changes

- @pexip/utils@16.1.0

## 16.0.0

### Patch Changes

- @pexip/utils@16.0.0

## 15.0.0

### Patch Changes

- @pexip/utils@15.0.0

## 14.1.0

### Patch Changes

- @pexip/utils@14.1.0

## 14.0.0

### Minor Changes

- c85b88f8: Add getFacingModeFromConstraintString

### Patch Changes

- @pexip/utils@14.0.0

## 13.2.0

### Patch Changes

- @pexip/utils@13.2.0

## 13.1.0

### Patch Changes

- @pexip/utils@13.1.0

## 13.0.0

### Major Changes

- 3750d84b: Only build esm bundle via tsup\

### Patch Changes

- @pexip/utils@13.0.0

## 12.0.0

### Patch Changes

- @pexip/utils@12.0.0

## 11.0.0

### Patch Changes

- @pexip/utils@11.0.0

## 10.1.0

### Patch Changes

- @pexip/utils@10.1.0

## 10.0.0

### Patch Changes

- @pexip/utils@10.0.0

## 9.0.0

### Minor Changes

- 5a852b05: No unnecessary reqeust on blocked devices

### Patch Changes

- @pexip/utils@9.0.0

## 8.0.0

### Patch Changes

- @pexip/utils@8.0.0

## 7.0.0

### Minor Changes

- 5d824c12: No unnecessary gUM for irrelevant device change

  ## '@pexip/media': minor

  - No unnecessary gUM for irrelevant device change

  closes https://gitlab.com/pexip/zoo/-/issues/3129

  ## '@pexip/media-control': minor

  - Add 2 new util functions
    - hasRequestingDevice,
    - shouldRequestDevice,

- efc7d2a8: Better media logging

  ## @pexip/logger

  - Add more AudioNode to log

  ## @pexip/media

  - Truncate unnecessary fields when logging with JSON

  ## @pexip/media-control

  - Put MediaDeviceInfoKind['settings'] fields into toJSON for logging

  ## @pexip/media-processor

  - Drop logger dependency and related usages

- dead15ae: Fix unplug and plug media fallback issue

  closes https://gitlab.com/pexip/zoo/-/issues/2986

  ## @pexip/media

  - Use the correct media status after release

  ## @pexip/media-control

  - Ignore ended track when validating the current device and the new constraint

### Patch Changes

- Updated dependencies [16854bc7]
  - @pexip/utils@7.0.0

## 6.0.0

### Patch Changes

- @pexip/utils@6.0.0

## 5.0.0

### Minor Changes

- 9f68146d: # Presentation with audio.

  Be able to share presentation with audio.

  ## Changes on `media`

  Introduce `audioMixingProcessor` to mix audio track with additional one.

  ## Changes on `media-control`

  Introduce `mixWithAdditionalMedia` constraint.

  ## Changes on `media-components`

  Pass a cleanup `fn` to `usePresentation` hook.

  ## Changes on `media-processor`

  Add `merger` node constructor.

### Patch Changes

- Updated dependencies [2e36be80]
  - @pexip/utils@5.0.0

## 4.0.0

### Minor Changes

- cf8bec29b6: # Use Streams API

  ## Changes on `media-processor`

  - Use Streams API for video processing, fallback to
    requestVideoFrameCallback/setTimeout when the API is not available
  - Turn off alpha when producing the final drawing on canvas
    - closes https://gitlab.com/pexip/zoo/-/issues/2186
  - Use desynchronized hint for canvas
  - Fix edge issue when composing blur background
  - Fix process `opened` state issue on async function

  ### Commits

  - fc398f4b38 perf(media-processor): use desynchronized hint
  - ed2d95c653 feat(media-processor): use stream transform
  - da53143a49 fix(media-processor): dom-webcodecs types
  - e271047b0f feat(media-processor): VideoProcessor accept transformers
  - eeb8992f97 feat(media-processor): add transformer creator
  - 20d085aac2 feat(media-processor): add MediaStreamTrack generator & processor
  - 096f1adc77 perf(media-processor): turn off alpha for none effect
  - a1a282c34a refactor(media-processor): move canvas related into
    canvasRenderer

  ## Changes on `media`

  - Use the latest APIs from `media-processor`
  - Fix types overridden by `dom-webcodecs`

  ### Commits

  - 0156012aab fix(media): use streams API from media-processor
  - e61ca85375 fix(media): type overrides

  ## Changes on `media-control`

  - Fix types overridden by `dom-webcodecs`

  ### Commit

  - 0a63010d20 fix(media-control): type overrides

  ## Changes on Apps

  - Use the latest APIs

  ### Commits

  - b7a768a350 feat(infinity-connect): turn on video processing for Safari
  - d05dc48b8f fix(media-processor-demo): remove comments
  - 6d58d0c987 fix(media-processor-demo): add missing await
  - 4859029594 fix(infinity-connect): apply latest changes from media
  - 3c30502ee7 fix(aquila): use latest changes from media
  - 179359a95d fix(media-demo): update settings as well
  - e3ac0cdd0e fix(media-demo): apply latest changes from media
  - f251c75f16 feat(media-processor-demo): use createCanvasTransform

  ## Others

  - Add types/dom-webcodecs

  ### Commit

  - 2458690b46 build: add types/dom-webcodecs

### Patch Changes

- @pexip/utils@4.0.0

## 2.1.0

### Minor Changes

- 0a054710b: Relax all input constraints

  Before we only relax the constraints when they are an `exact` constraints,
  after the change we relax all constraints when possible to be more
  forgiveness.

- acedce8d8: Decouple resolution check from device check

  ## '@pexip/media-control'

  - Decouple resolution check from `isRequestedInputDevice` and add a new
    function to verify the resolution `isRequestedResolution`

  ## '@pexip/media'

  - Use `isRequestedResolution` to check the resolution to decide if we should
    request the media again

- b3cbb8a59: Fallback input device notification

  ## '@pexip/aquila'

  - Add `useFallbackDeviceNotifier` hook and use it in Preflight
  - Log the global `Notifyer` whenever there is a new toast.
  - Fix an unnecessary update of the selected inputs when media is set to
    `undefined`

  ## '@pexip/media'

  - Extract the device info and put it to
    `expectedVideoInput`/`expectedAudioInput` when we cannot find the device
    from the current device list for completeness.
  - Use `isStreamingRequestedDevices` instead of
    `isStreamingRequestedDevicesBase` to have more info about the track

  ## '@pexip/media-control'

  - Add a new utility function, `extractDeviceFromConstraints`, to extract the
    device info from the provided constraints
  - Update `isStreamingRequestedDevices` to allow passing `undefined` stream
    param.

- 57eb593c0: Be more forgiveness when comparing input devices

  When checking against the requested input device with the constraints
  provided, it is better to use the label to verify them to avoid stale
  `deviceId` issue.

  ## '@pexip/media'

  - Should always use permission granted devices to do the comparison

  ## '@pexip/media-control'

  - Use device's label to compare device when possible

- 8e3e3b1f9: Refactor media package to follow the media constraint pattern

  https://developer.mozilla.org/en-US/docs/Web/API/Media_Streams_API/Constraints

  - Move and extend the media features based on MediaTrackConstraints by
    interpreting the provided constraints
    - Voice Activity Detection - `vad` of type `boolean`
    - Audio Signal Detection - `asd` of type `boolean`
    - Noise suppression - `denoise` (to avoid the conflict of the built-in
      `noiseSupression`) of type `boolean`, `true` means using our own impl,
      remember to disable the built-in `noiseSupression` as you don't want to
      use them both
    - Blur level - `blurLevel` of type `number`
    - Erode param - `erode` of type `number`
    - Video segmentation effects - `videoSegmentation` of type `none`, `blur`,
      `overlay` or `remove` (`remove` will be added in another MR)
  - Ad-hoc change of the features should be done via the `Media` object with the
    new `applyConstraints` API
  - `getUserMedia` is always getting a new media while applying the features
    based on the constraints when there is change to the constraints

  Example:

  ```typescript
  const constriants = {
    audio: {
      noiseSuppression: false, // Disable the built-in noise suppression
      denoise: true, // Use our own impl of noise suppression
      vad: true, // Use Voice Activity Detection
      asd: true, // Use Audio Signal Detection to check if the microphone is malfunctioned
    },
    video: {
      videoSegmentation: 'blur', // Use background blur
      erode: 1,
      blurLevel: 21,
    },
  };
  ```

  The new `MediaController` interface (removed feature-related props):

  ```typescript
  export interface MediaController {
    /**
     * Current Media if any
     */
    media: Media;
    /**
     * Current device list
     */
    devices: MediaDeviceInfoLike[];
    /**
     * Execute the media pipeline immediately with provided constraints
     *
     * @param constraints - @see MediaDeviceRequest
     */
    getUserMedia: (constraints: MediaDeviceRequest) => void;
    /**
     * Execute the media pipeline immediately with provided constraints. An
     * explicit version of `getUserMedia` to make it possible to chain other
     * async actions
     *
     * @param constraints - @see MediaDeviceRequest
     */
    getUserMediaAsync: (constraints: MediaDeviceRequest) => Promise<void>;
    /**
     * Cross-check PermissionState and available devices before requesting user
     * media, the request will be skipped if there is no granted device.
     */
    tryAndGetUserMedia: (constraints: MediaDeviceRequest) => void;
  }
  ```

  The new `Media` interface (added `applyConstraints`):

  ```typescript
  export interface Media {
    /**
     * The constraints used to request the media
     */
    constraints?: MediaDeviceRequest;
    /**
     * The devices used for the media
     */
    devices: MediaDeviceInfoLike[];
    /**
     * Media stream for the media
     */
    stream?: MediaStream;
    /**
     * The raw stream obtained from the `getUserMedia` API
     */
    rawStream?: MediaStream;
    /**
     * Audio input device is used for the audio track from the current stream
     */
    audioInput?: MediaDeviceInfoLike;
    /**
     * Video input device is used for the video track from the current stream
     */
    videoInput?: MediaDeviceInfoLike;
    /**
     * The audio input device which is expected to be used for the current
     * stream based on the provided constraints
     */
    expectedAudioInput?: MediaDeviceInfoLike;
    /**
     * The video input device which is expected to be used for the current
     * stream based on the provided constraints
     */
    expectedVideoInput?: MediaDeviceInfoLike;
    /**
     * The status of the media
     */
    status: UserMediaStatus;
    /**
     * Current mute state of audio track
     * `undefined` means there is no such track from the stream
     */
    audioMuted: boolean | undefined;
    /**
     * Current mute state of video track
     * `undefined` means there is no such track fromt the stream
     */
    videoMuted: boolean | undefined;
    /**
     * mute/unmute the audio track
     */
    muteAudio(mute: boolean): void;
    /**
     * mute/unmute the video track
     */
    muteVideo(mute: boolean): void;
    /**
     * Apply the constraints to the current media
     */
    applyConstraints(constraints: MediaDeviceRequest): Promise<void>;
    /**
     * Release the media resources, e.g. camera/microphone
     */
    release(): Promise<void>;
  }
  ```

- 048e384e7: Fix device selection misbehavior

  ## fix(media-control): use delete operator to override constraints keys

  - Use delete operator to override constraints keys instead of setting them as
    `undefined` to avoid unintended key-value overriding

  ## fix(aquila): avoid using deep property access with optional chaining

  - Avoid using deep property access with optional chaining to workaround
    unknown behavior of missing the optional chaining operator after
    compilation.
  - Improve the log

### Patch Changes

- Updated dependencies [3b3883832]
  - @pexip/utils@2.1.0

## 2.0.0

### Minor Changes

- 0430bbad2: ## '@pexip/media'

  Add mute state and related events

  - Add `audioMuted` and `videoMuted`
  - Connect `MediaStreamTrack` native events to signals
  - Add and connect `onStreamTrackEnabled` signal
  - Refactor `buildMedia`

  ## '@pexip/media-demo'

  Add mute state and related logics

  ## '@pexip/media-control'

  Change `createStreamTrackEventSubscriptions` to accept track instead of
  stream.

- cf2493ea9: Fix blocked device selection issues

  ## @pexip/aquila

  - Add i18n to `DeviceSelect` component
  - Use `MissDeviceAlert` component only when there is denied device or no
    device available for selection

  ## @pexip/components

  - Add `errorTextId` prop to `Select` component for testing

  ## @pexip/media

  - Add more props to Media

    Add `status`, `expectedAudioInput`, `expectedVideoInput`, `constraints` to
    `Media`

  ## @pexip/media-control

  - Add `findDeviceFromDeviceConstraints` util

    Find device from the device list with provided constraints, i.e.
    `InputDeviceConstraint` -> `MediaDeviceInfoLike | true | undefined`. It
    returns `true` meaning that it can be any devices, `undefined` means device
    not found, otherwise, the matched device will be returned

- 07caf0c47: Fix behavior signal `onDeviceChanged` issue

  ## General

  The behavior signal of `onDevicesChanged` can
  [cause problem](https://gitlab.com/pexip/zoo/-/issues/1780) when there is no
  device at all.

  Indeed, there is no need to use a behaving signal, a generic one is good
  enough for our usecase of `onDevicesChanged`. What we need to do before we
  initiate the initial `getUserMedia` is to cross-check with the
  `PermissionState` and the `devices`, and thus `tryAndGetUserMedia` API is
  introduced to do the job.

  ## Changes

  ### fix(aquila): use preflight page to trigger media request

  - Change `onDevicesChanged` to a `generic` signal, instead of `behavior`
  - Use Preflight to trigger media request

  closes https://gitlab.com/pexip/zoo/-/issues/1780

  ### feat(aquila): add useGetUserMedia hook

  - Add `useGetUserMedia` hook to trigger permission validation and initiate
    media request

  ### feat(media): new tryAndGetUserMedia API

  - Add `tryAndGetUserMedia`
  - Check if there is any actual changes of devices

  ### refactor(media-control): for re-usability

  - Refactor `createTrackDevicesChanges` to allow passing initial state

- 31c667453: Move findDevice utility function to utils file to avoid circular
  import
- 029f5fb8a: Fix unique devices function
- 5ad1a1e92: Remove `skipFilter` and `shouldRetainAudio`

  - Remove `skipFilter` parameter for `getDevices`

    The decision should be made at application level

  - Remove `shouldRetainAudio` option for `MediaDeviceRequest`

    Side effect is always bad

- c1bf7f05c: Remove duplicated devices before checking changes

  - Extract the logic to track device changes, and add unit test cases
  - Remove duplicated devices when tracking changes from `devicechange` event
  - Use `MediaDeviceInfoLike` instead `MediaDeviceInfo` for related events

  A bug from Firefox (v88.0.1) 64-bit or above, there is chance that the devices
  we get from the API `enumerateDevices` are not unique with particular devices,
  e.g. Logitech BRIO. Since we are relying on the uniqueness for tracking the
  changes of device to fire `devices:found` or `devices:lost` events, this
  causes all the operations relying on these events, e.g. false positive
  `devices:found` event.

  See https://gitlab.com/pexip/zoo/-/issues/1743

- 72641f2cd: Fix `isConstraintSet`

  - The type guard for checking if the provided value is a constraint yields a
    false positive

  Fix signal subscription issue

  - Under a certain situation, the detach function will be called multiple times

### Patch Changes

- 281f3afbe: Support `MediaStreamConstraints`, same as
  `MediaDevices.getUserMedia()`

  With this MR, the API for `getUserMedia` has been simplified and now is
  following the design of `MediaDevices.getUserMedia()` API with an extension of
  an extra key, `device`, to `MediaStreamConstraints` and also retain the
  capability of using `MediaDeviceInfo`/`MediaDeviceInfo[]` as constraints.

  EXAMPLES:

  ```typescript
  import {getUserMedia} from '@pexip/media-control';
  const audioInput = {
    deviceId: 'a-id-1',
    kind: 'audioinput',
    label: 'fake-audio',
  };
  const videoInput = {
    deviceId: 'v-id-2',
    kind: 'videoinput',
    label: 'fake-video',
  };

  // To get a stream with specific devices when available
  const stream = await getUserMedia({audio: audioInput, video: videoInput});
  // The above constraints provided will be converted as
  // `{audio: {deviceId: {ideal: ['a-id-1']}}, video: {deviceId: {ideal: ['v-id-2']}}}`
  // to pass to MediaDevices.getUserMedia

  // To get a stream with exact devices
  const stream = await getUserMedia({
    audio: {device: {exact: audioInput}},
    video: {device: {exact: videoInput}},
  });
  // The above constraints provided will be converted as
  // `{audio: {deviceId: {exact: ['a-id-1']}}, video: {deviceId: {exact: ['v-id-2']}}}`
  // to pass to MediaDevices.getUserMedia

  // To get a stream with front facing camera, same as MediaDevices.getUserMedia
  const stream = await getUserMedia({
    audio: true,
    video: {facingMode: 'user'},
  });
  ```

  BREAKING CHANGES:

  - Rename/remove some keys of `MediaStreamRequest`

    - `audioInput` and `videoInput` are renamed to `audio` and `video`
      respectively to follow the spec.
    - `exactAudioInput` and `exactVideoInput` are removed. In order to request
      exact devices, it is now required to follow the pattern of
      `MediaStreamConstraints` with `device` key. Thus there is **NO default for
      requesting exact devices**.
    - `NotFoundError` is tuned to be more specific when possible to verify with
      `getDevices` and the provided constraints

      If we can derive the `NotFoundError` from `devices` and `constraints` We
      throw `AudioAndVideoDeviceNotFoundError`, `AudioInputDeviceNotFoundError`
      or `VideoInputDeviceNotFoundError` else, we throw the original
      `NotFoundError`

  closes #1428

- 649e27941: - Support constraints pattern for `isRequestedInput` utility

  - Rename `hasRequestedStream` to `isStreamingRequestedDevices`, and it is now
    return an object with keys `audio` and `video` to show exact result.

    E.g. `{audio: true, video: true}` means that it is streaming the exact
    devices as requested

- 6ddadd2e5: Support facingMode stream track and constraint comparison
- 839436f8d: ## @pexip/media

  - Only use `error` level when on the following errors when requesting media,
    otherwise, `warn` level

    - `TypeError`
    - `NotSupportedError`
    - `UnknownError`
    - `OverconstrainedError` (when it is not `exact` device request)

  ## @pexip/media-control

  - Add `isExactDeviceConstraint` utility to check if the provided constraint is
    an exact constraint

## 1.4.0

### Minor Changes

- 5c9120efd: Track changes using changesets

## [0.14.3] - 2021-03-22

### Fixed

- Entry points issue

## [0.14.2] - 2021-03-19

### Fixed

- Fix lsp error about "downlevelIteration"

### Changed

- Use tslib to avoid duplicate declarations to use together with
  "downlevelIteration"
- Rename test file to use the same pattern as aquila, aka xxxx.test.ts
- Remove Fake camera related codes

  Fake camera is not used in both aquila and sleipnir

## [0.14.1] - 2021-03-11

### Fixed

- Accessing `mediaDevices` when it is disabled/unavailable
- Consistent `getDevices`
- Add more logs

## [0.14.0] - 2021-03-11

### Changed

- Remove api-extractor and related

## [0.13.2] - 2021-03-02

### Fixed

- make sure we always get initial `enumerateDevices` [#3679]
- fix `setInterval` fallback for `ondevicechange` [#3679]

## [0.13.1] - 2021-02-26

### Added

- debug logs [#3659]

## [0.13.0] - 2021-02-25

### Added

- `setLogger` function to set the global logger for this module

## [0.12.3] - 2021-02-16

### Changed

- Remove @babel/core, tslib and @pexip/logger dependencies

  Note: @babel/core was added by #1916 to resolve the unmet peer deps warning
  but it is only needed when using the Node API[1]. Thus it is considered as
  unnecessary for our situation.

  [1]: https://babeljs.io/docs/en/babel-plugin-transform-runtime#via-node-api

## [0.12.2] - 2021-02-16

### Fixed

- Compare the request and the track directly for `hasRequestedStream`, to fix
  #3523

  Since the device list from `enumerateDevices` from Firefox Nightly always
  return a set of fake devices. We should not rely on looking up the device info
  from the `enumerateDevices`, and should comparing them directly.

## [0.12.1] - 2021-02-11

### Fixed

- DevicesUnauthorized should comes with authorized devices when available for
  completeness

## [0.12.0] - 2021-02-10

### Changed

- Emit DevicesUnauthorized/NoInputDevices event
- DevicesFound/DevicesLost comes with the latest device list, `currentDevices`

### Added

- Add utils to check media request against current MediaStream
  hasRequestedStream

## [0.11.0] - 2021-02-09

### Changed

- BREAKING CHANGE: Consistent device change event

  DevicesChanged/DevicesFound/DevicesLost events are no longer emit modified
  devices. It emits what it gets from the getDevices, aka
  navigator.mediaDevices.enumerateDevices(), to allow the interpretation of
  media device permission status.

  It also make the DevicesFound/DevicesLost events emitted consistently

## [0.10.2] - 2021-01-29

### Fixed

- Fix `findDevice` fallback issue, see
  [#3178](https://github.com/pexip/aquila-research/issues/3178)

  ```typescript
  const d1 = {deviceId: '01', label: 'A'};
  const d2 = {deviceId: '02', label: 'B'};
  const d3 = {deviceId: '03', label: 'A'};
  const d4 = {deviceId: '04', label: 'B'};
  const d5 = {deviceId: '05', label: 'A'};
  const d6 = {deviceId: '06', label: 'B'};
  const devices = [d1, d2, d3, d4];

  // With useFallback flag is `true`, the default
  findDevice(d1)(devices); // d1
  findDevice(d2)(devices); // d2
  findDevice(d3)(devices); // d3
  findDevice(d4)(devices); // d4
  findDevice(d5)(devices); // d1
  findDevice(d6)(devices); // d2

  // With useFallback flag is `false`
  findDevice(d1, false)(devices); // d1
  findDevice(d2, false)(devices); // d2
  findDevice(d3, false)(devices); // d3
  findDevice(d4, false)(devices); // d4
  findDevice(d5, false)(devices); // undefined
  findDevice(d6, false)(devices); // undefined
  ```

## [0.10.1] - 2020-12-10

### Fixed

- Fix `devicechange` in Safari

## [0.10.0] - 2020-11-23

### Added

- added new helper methods `findCurrentVideoInputDeviceIdFromStream`,
  `findDeviceWithDeviceId`, `findDevicesByKind`, `findAudioInputDevices`,
  `findVideoInputDevices`, `findAudioOutputDevices`, `stopMediaStream`,
  `hasAudioOrVideoInputs`, `hasAudioInputs`, `hasVideoInputs`.

### Changed

- rename `isAudioOrVideoInput` to `hasAudioOrVideoInputs`

## [0.9.0] - 2020-11-17

### Changed

- don't filter out default devices

## [0.8.0] - 2020-10-28

### Added

- `areTracksEnabled` - helper that checks if all the tracks in media stream are
  enabled [#1973](https://github.com/pexip/aquila-research/pull/1973)

## [0.7.0] - 2020-10-28

### Added

- `muteStreamTrack` - Set `MediaStreamTrack['enabled']` according to `mute`
  parameter for the provided `stream`

## [0.6.0] - 2020-10-23

### Added

- `compareMediaDeviceToMediaTrack` - compares track and MediadeviceInfo
  `findMediaInputFromMediaStreamTrack` - get media input info from track
  `findMediaInputFromStream` - get media input info from MediaStram
  `findPermissionGrantedDevices` - devices with labels
  `findCurrentAudioOutputId` - always return correct sinkId
  `isAudioOrVideoInput` - check if audioinput or videoinput devices in the list
  [#1947](https://github.com/pexip/aquila-research/pull/1947)

### Removed

- **BREAKING**: Remove `findDeviceFromStreamTrack`
  [#1947](https://github.com/pexip/aquila-research/pull/1947)
